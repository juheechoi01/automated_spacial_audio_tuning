# Automated Spacial Audio Tuning with AI
### 2023-2학기 고려대 미디어학부 전공선택과목 '영화론' 프로젝트
주희: 알고리즘 제작 및 음향 보정 작업
재하: 설명 영상 제작 및 영상 소스 제공
세원, 문철: 포스터 제작 및 보고서 작성

## Introduction
### Issues
영화 '도둑들'은 많은 평론가들의 호평을 받았으나 후시 녹음 음향으로 인해 이질감을 느꼈다는 대중들의 비난이 존재해왔다. 영화의 음향은 크게 전시, 동시, 후시 3가지 방식으로 구성되는데 대한민국의 영화 산업에서는 대체로 촬영 이후에 녹음하는 후시 녹음 방식을 채택하고 있다. 현재 기술로서는 동시 녹음이 아직 후시 녹음만큼의 수준 높은 음향을 제공하지 못하기 때문이다. 

다만 이러한 후시 녹음은 치명적인 한계가 존재한다. 동시 녹음에서 활용하는 단일지향성 마이크는 음향공간을 표현할 수 있는 반면에, 후시 녹음에서 사용되는 마이크는 이를 표현할 수 없다. 다시 말해, 소리의 거리나 좌우 방향이 표현되지 않는다는 것이다. 이는 영화의 시각적 요소인 영상과 청각적 요소인 음향의 부조화를 야기하여 영화에 대한 대중들의 몰입을 깨뜨린다. 

### Objectives
따라서 본 프로젝트에서는 이러한 영화 산업에서의 문제점을 해결하기 위해 후시녹음에 음향공간을 부여할 수 있는 AI 프로그램 개발하고자 한다. 좌우 음향 조정된 사운드와 그렇지 않은 사운드를 직접 비교하여 들어봄으로써 음향이 영상 몰입도에 얼마나 영향을 주는지 알 수 있다. 

## Methods - Mediapipe
우리는 Google에서 제공하는 AI 프레임워크인 Mediapipe를 이용하여 해당 프로그램을 개발할 예정이다. 비디오 형식 데이터를 이용한 다양한 vision AI 기능을 파이프라인 형태로 손쉽게 사용할 수 있도록 제공되는 프레임워크로 python 환경에서 사용하기 편리한 라이브러리 형태로 제공된다. 

인체를 대상으로 하는 인식(detection)에 대해서 얼굴 인식, 포즈, 객체 감지, 모션 트레킹 등 다양한 형태의 기능과 모델을 제공한다. 우리의 프로젝트의 경우, Mediapipe Solution 중 Face Mesh Method을 사용해서 얼굴 특히, 입술에 찍히는 랜드마크의 위치 값(x, y)을 받아 자동으로 음향 보정을 할 수 있게끔 모델 경로를 짤 계획이다. 예를 들어 입술에 찍히는 랜드 마크의 위치가 오른쪽에 있다고 하면 Right side의 음향을 더 높이는 등 전체적인 음량을 조절할 수 있다. 이렇게 후시 녹음된 음원의 좌우 방향을 표현하고 공간감을 만들어주는 모델을 제작했다.

특히 입술 부분에 있는 랜드마크들의 x좌표 평균을 기준으로 입술의 가장 가운데 부분을 트래킹했다. landmark => [0, 11, 12, 13, 14, 15, 16, 17]

![image](https://github.com/juheechoi01/automated_spacial_audio_tuning/assets/109716683/c95707fb-595b-45e7-ae43-80ce104d53f1)

## Results - Mechanism of the Program
비디오 산업에서 통용되는 16:9 해상도의 영상을 기준으로 돌아가게끔 설정했다. 가장 중앙을 O라고 표시하고, 중심을 기준으로 입술이 왼쪽에 위치하면 동시에 음향의 L값을 키우고, R값을 줄여야 한다. 또한 인간 음성의 경우 -6 ~ -18dB 사이를 유지해야 하기 때문에 만약 영상의 가장 왼쪽에 입술이 위치한다면 L값은 -6dB, R값은 -18dB이 되게끔 설정한다.  

[![Video Label](http://img.youtube.com/vi/eTaSXu5qTQM/0.jpg)](https://www.youtube.com/watch?v=eTaSXu5qTQM)

## Conclusion
영화에서 음향과 화면 사이의 오차를 줄임으로써 관객의 몰입을 높일 수 있다. 이러한 접근법은 영화 제작 후 일일히 좌우 음향 보정을 하는 노동집약적인 측면을 줄이고 복잡한 과정을 완화함으로써 영화감독과 제작자들이 영화의 전반적인 질을 높이는 데 집중할 수 있도록 한다. 궁극적으로 이 프로그램의 개발은 한국 영화 산업의 활성화에 긍정적인 영향을 미칠 것으로 보인다. 

다만 한계점으로 사람이 말하는 시간대를 파악하여 입술 위치와 후시 녹음의 LR 사운드 조정을 진행했지만, 특정 영상에 specified하게 알고리즘을 제작했고, 모든 영상에 적용시킬 만한 알고리즘까지 제작하지 못했다. 그러나 추후에 해당 알고리즘을 만들고 더 나아가 Python 환경에서 음향 파일을 수정하지 않고 어도비 Premiere Pro와 같은 영상 편집 툴에서 플러그인 프로그램으로 자리잡을 수 있도록 추후에 더 발전시킬 수 있을 것이다. 
